<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Test WebSocket Server</title>
  </head>
  <body>
    <h2>K·∫øt n·ªëi WebSocket</h2>
    <p id="status">ƒêang k·∫øt n·ªëi...</p>

    <input type="text" id="messageInput" placeholder="Nh·∫≠p tin nh·∫Øn..." />
    <button id="sendBtn">G·ª≠i</button>

    <h3>Log:</h3>
    <pre id="log"></pre>

    <script>
      let start = new Date();
      const logEl = document.getElementById("log");
      const statusEl = document.getElementById("status");
      const input = document.getElementById("messageInput");
      const sendBtn = document.getElementById("sendBtn");

      function log(msg) {
        logEl.textContent += msg + "\n";
      }

      // K·∫øt n·ªëi t·ªõi server WebSocket
      const ws = new WebSocket("https://api.mintynfts.com");

      ws.onopen = () => {
        statusEl.textContent = "‚úÖ ƒê√£ k·∫øt n·ªëi t·ªõi server";
        log("K·∫øt n·ªëi th√†nh c√¥ng.");
        const end = new Date();
        const latency = end - start; // t√≠nh ra mili-gi√¢y
        console.log(`Latency: ${latency} ms`);
      };

      ws.onmessage = (event) => {
        log("üì© Server: " + event.data);
        const end = new Date();
        const latency = end - start; // t√≠nh ra mili-gi√¢y
        console.log(`Latency: ${latency} ms`);
      };

      ws.onclose = () => {
        statusEl.textContent = "‚ùå M·∫•t k·∫øt n·ªëi";
        log("K·∫øt n·ªëi ƒë√≥ng.");
      };

      ws.onerror = (err) => {
        log("‚ö†Ô∏è L·ªói WebSocket: " + err.message);
      };

      sendBtn.onclick = () => {
        const msg = input.value.trim();
        if (msg) {
          ws.send(msg);
          start = new Date();
          input.value = "";
        }
      };
    </script>
  </body>
</html>
